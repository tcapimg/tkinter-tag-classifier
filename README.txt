タグ分類・生成アプリ (Tkinter版)

この下の文章もGEMINIに作ってもらったので非常にわかりづらいですが改変とかは自由にしてください。プログラムなんもわからん。

このアプリケーションは、画像生成AIなどで使用するタグの管理、分類、およびタグセットの生成を効率的に行うためのツールです。
カテゴリ階層を作成し、タグを整理することで、より意図通りの画像を生成するためのプロンプト作成をサポートします。

1. アプリケーションの概要
* カテゴリ・辞書管理: タグを分類するためのカテゴリを階層的に管理し、各カテゴリにタグ（英語タグ名、日本語説明）を登録・編集できます。
* タグ分類作業: 未分類のタグリストを読み込み、辞書内の既存タグと照合して自動分類ヒントを提供します。手動でカテゴリを割り当て、辞書に一括追加できます。
* タグセット生成: 辞書に登録されたタグから、必要なタグを検索・選択して、任意の区切り文字で連結されたタグセットを生成できます。
* ランダムタグ生成: 各最終カテゴリ（子カテゴリを持たないカテゴリ）からランダムにタグを選択し、タグセットを自動生成します。
2. アプリケーションの起動方法
1. 提供されたPythonスクリプトファイル（tag_classification_app_tkinter.py）と、もしあればrun_app.batが同じディレクトリにあることを確認してください。
2. run_app.batをダブルクリックして実行します。
   * Python環境が正しくセットアップされていれば、アプリケーションが起動します。
   * もしrun_app.batがない場合や、エラーが発生する場合は、コマンドプロンプト（またはターミナル）を開き、スクリプトがあるディレクトリに移動して以下のコマンドを実行してください。
python tag_classification_app_tkinter.py

   * 必要なライブラリ（pandas）がインストールされていない場合は、以下のコマンドでインストールしてください。
pip install pandas

3. 各タブの機能と使い方
3.1. カテゴリ・辞書管理
このタブでは、タグのカテゴリ構造と辞書に登録されているタグ自体を管理します。
3.1.1. カテゴリ階層の閲覧 (左側)
   * 登録されているカテゴリがツリー形式で表示されます。
   * カテゴリ名をクリックすると、そのカテゴリに属するタグが表示されます。
   * カテゴリを右クリックすると、以下の操作が可能です。
   * 「[カテゴリ名]」の子カテゴリを追加: 新しいカテゴリ追加セクションの親カテゴリに選択したカテゴリが自動で設定され、タブが切り替わります。
   * 「[カテゴリ名]」を削除: 子カテゴリやタグが含まれていない場合にのみ削除できます。
3.1.2. 辞書ファイルの操作 (右側上部)
   * 既存の辞書JSONファイルをアップロード: 外部に保存されている辞書JSONファイルを読み込み、現在の辞書を上書きします。
   * 現在の辞書データをJSONでダウンロード: 現在の辞書データをJSONファイルとして保存します。
   * デモ用初期辞書を生成: アプリケーション起動時に辞書がない場合や、初期状態に戻したい場合に、デモ用のカテゴリとタグが自動で生成されます。
   * 追加辞書JSONファイルをインポート (マージ): 別の辞書JSONファイルを読み込み、現在の辞書にマージします。重複するカテゴリやタグはスキップされます。
3.1.3. 新しいカテゴリの追加 (右側中央)
   * 新しいカテゴリ名: 追加したいカテゴリの名前を入力します。
   * 親カテゴリ: ドロップダウンから、新しいカテゴリの親となるカテゴリを選択します。トップレベルのカテゴリにする場合は「--カテゴリを選択--」のままにします。
   * カテゴリを追加: 入力した情報で新しいカテゴリを辞書に追加します。
3.1.4. カテゴリとタグの編集 (右側下部)
   * カテゴリで絞り込み: ドロップダウンからカテゴリを選択すると、そのカテゴリとその子カテゴリに属するタグのみが表示されます。
   * タグを検索: 英語タグ名または日本語説明でタグを検索できます。
   * タグ一覧:
   * 辞書に登録されているタグが表示されます。
   * 各列のヘッダーをクリックすると、その列で昇順/降順にソートできます。
   * 「日本語説明」または「カテゴリ」のセルをダブルクリックすると、直接編集できます。
   * 日本語説明: テキストを直接入力し、Enterキーで確定します。
   * カテゴリ: ドロップダウンから新しいカテゴリを選択します。
   * タグ（英語タグ名）を右クリックすると、「[英語タグ名] をコピー」でクリップボードにコピーできます。
   * 選択したタグにまとめてカテゴリを適用: 複数のタグを選択（Ctrl/Cmdキーを押しながらクリック）し、ドロップダウンからカテゴリを選んで「選択したタグに適用」ボタンを押すと、一括でカテゴリを変更できます。
   * タグの変更を保存: タグ一覧で編集した内容や、一括適用したカテゴリの変更を辞書ファイルに保存します。この操作を行うまで、変更は一時的なものです。
3.1.5. 日本語説明の一括追加・更新 (右側下部)
   * 日本語説明がないタグをエクスポート (.txt): 日本語説明が空、または「説明なし」のタグのみをテキストファイルとしてエクスポートします。翻訳作業に利用できます。
   * 翻訳済みタグをインポート (.csv): English Tag と 日本語説明 の2列を持つCSVファイルを読み込み、辞書内の対応するタグの日本語説明を更新します。
   * 重要: この機能は、辞書内のタグの既存の日本語説明が空、または「説明なし」である場合に限り、CSVの新しい日本語説明で更新します。既に日本語説明があるタグは上書きされません。
   * 全タグをCSVでエクスポート (編集用): 辞書内の全てのタグ（英語タグ名と日本語説明）をCSVファイルとしてエクスポートします。これも翻訳作業や一括編集のテンプレートとして利用できます。
3.2. タグ分類作業
このタブでは、外部から読み込んだ未分類のタグリストを辞書に分類・追加する作業を行います。
   * 未分類タグリストを読み込む: テキストファイル（タグがカンマ区切りまたは改行区切り）またはCSVファイル（1列目にタグ）を読み込みます。辞書に既に存在するタグは自動でスキップされます。
   * 未分類タグ一覧:
   * 読み込まれた未分類タグが表示されます。
   * 自動で分類ヒント（日本語説明やカテゴリ）が提案されます。
   * 「日本語説明」または「カテゴリ」のセルをダブルクリックして、手動で編集できます。
   * 選択したタグにまとめてカテゴリを適用: 複数のタグを選択し、ドロップダウンからカテゴリを選んで一括適用します。
   * テーブルで分類したタグを辞書に追加: 未分類タグ一覧で分類（カテゴリと日本語説明を割り当てた）したタグを辞書に正式に追加します。追加後、分類済みのタグはリストから削除されます。
   * 未分類タグリストをクリア: 未分類タグ一覧の表示をクリアします。
3.3. タグセット生成
このタブでは、辞書に登録されたタグから、必要なタグを選択してタグセット（プロンプト）を生成します。
   * 利用可能タグ (辞書より):
   * 辞書に登録されている全てのタグが表示されます。
   * カテゴリで絞り込みや、タグ名・説明での検索が可能です。
   * タグを選択し、「選択したタグを追加」ボタンで「選択済みタグ」リストに追加します。
   * 選択済みタグ:
   * 生成したいタグセットに含まれるタグが表示されます。
   * タグを選択し、「削除」ボタンでリストから削除できます。
   * 「上に移動」「下に移動」ボタンでタグの順序を変更できます。
   * 生成されたタグテキスト:
   * 「選択済みタグ」リストのタグが、指定した区切り文字で連結されて表示されます。
   * 「区切り文字」ドロップダウンで、カンマ、アンダースコア、パイプ、スペースなどを選択できます。
   * 「クリップボードにコピー」ボタンで、生成されたテキストを簡単にコピーできます。
3.4. ランダムタグ生成
このタブでは、辞書のカテゴリ構造を利用して、ランダムなタグセットを生成します。
   * ランダムタグセットを生成: 各最終カテゴリ（子カテゴリを持たないカテゴリ）からランダムに1つずつタグを選択し、タグセットを生成して表示します。
   * このランダムタグセットを選択済みに追加: 生成されたランダムタグセットを、「タグセット生成」タブの「選択済みタグ」リストに一括で追加します。
4. 翻訳作業のワークフロー（Google Sheetsの使用）
CSVファイルを翻訳ツールで直接開くと構造が崩れる問題は、Google Sheetsを使うことで解決できます。
   1. 「全タグをCSVでエクスポート (編集用)」 ボタン（「カテゴリ・辞書管理」タブ）を使用して、辞書内の全てのタグをCSVファイルとしてエクスポートします。
   * このCSVファイルは、通常 English Tag と 日本語説明 の2列で構成されます。
   2. Google Sheetsにインポート:
   * Google Sheetsを開き、「ファイル」→「インポート」からエクスポートしたCSVファイルをアップロードします。
   * この際、区切り文字がカンマであることを確認してください。
   3. 新しい列に翻訳を追加:
   * 例えば、列Aに英語タグ、列Bに既存の日本語説明があるとします。
   * 列C（または任意の空いている列）に、英語タグの翻訳結果を表示させます。
   * セルC1に以下の数式を入力します:
=GOOGLETRANSLATE(A1, "en", "ja")

   * この数式を列Cの必要な範囲（例: C2, C3...）にコピーします。これで列Aの英語タグが自動的に日本語に翻訳されます。
      4. 翻訳されたタグを元の列にコピー:
      * 列Cの翻訳された日本語タグ（GOOGLETRANSLATEの結果）をすべて選択してコピーします。
      * 列Bに値として貼り付けます。これにより、元の英語タグが翻訳された日本語タグに置き換わります。
      * 必要であれば、列Cは削除しても構いません。
      5. CSVファイルとしてエクスポート:
      * 翻訳が完了したら、「ファイル」→「ダウンロード」→「カンマ区切りの値（.csv）」を選択して保存します。
      6. アプリケーションにインポート:
      * 保存したCSVファイルを、アプリケーションの「カテゴリ・辞書管理」タブにある「翻訳済みタグをインポート (.csv)」ボタンで読み込みます。
      * これにより、辞書内の日本語説明が空または「説明なし」のタグのみが、CSVの新しい日本語説明で更新されます。
5. 注意事項とトラブルシューティング
      * UIの見切れ: アプリケーション起動時にウィンドウサイズが小さい場合、「日本語説明の一括追加・更新」セクションなど一部のUIが見切れることがあります。その場合は、ウィンドウの右下をドラッグしてサイズを大きくしてください。
      * データファイル: 辞書データは tag_dictionary.json というファイルに保存されます。このファイルを削除すると、辞書データは失われますのでご注意ください。
      * エラー発生時: もしアプリケーションの実行中にエラーが発生した場合は、メッセージボックスでエラー内容が表示されます。詳細な情報は、アプリケーションを起動したコマンドプロンプト（またはターミナル）に表示されることがありますので、そちらもご確認ください。
